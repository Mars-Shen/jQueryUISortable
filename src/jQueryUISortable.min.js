!function(a){"function"==typeof define&&define.amd?define(["jquery","jqueryui"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){var b="sorttable",c="v0.0.1",d={groupMode:!0,keyValueMode:!0,enableNewItem:!1,defaultNewItemKey:"NK",defaultNewItemText:"new value",sortJsonData:[],activeButton:!0,activeButtonText:"Active/Inactive",batchButton:!0,batchButtonText:"Batch Mode",normalModeButtonText:"Normal Mode",editButton:!0,editButtonText:"Edit",saveButtonText:"Save",cancelButtonText:"Cancel",addButton:!0,addButtonText:"Add",deleteButton:!0,deleteButtonText:"Delete",submitButton:!0,submitButtonText:"Submit",submitCallBack:function(){},deleteCallBack:function(){return confirm("Do you want to delete this record(s)")},buttonClass:""},e=function(e,f){this.element=e,this.elementId=a(e).attr("id"),this.disableUlElement=null,this.ulElement=null,this.buttonElements=null,this.sortableObj=null,this.startIndex=0,this.options=a.extend({},d,f),this.activedData=[],this.inactivedData=[],this.newAddedItemsArr=[],this.deletedItemsArr=[],this.selectedItem={},this.isBatchJob=!1,this.isEditMode=!1,this.selectNumber=0,this._defaults=d,this._name=b,this._version=c,this.init()};e.prototype={init:function(){"undefined"!=typeof this.sortableObj&&null!==this.sortableObj&&(this.sortableObj.sortable("destroy"),this.sortableObj=null),this.buildSortHTML(),this.buildSortTable(),this.refreshData();var b=this;a(this.element).off("click","li").on("click","li",function(){b.selectItemFunction(a(this))}),a(this.element).off("click","#"+this.elementId+"_submit").on("click","#"+this.elementId+"_submit",function(c){"function"==typeof b.options.submitCallBack?b.options.submitCallBack(c):a.error("SubmitCallBack "+b.options.submitCallBack+" is not a function!")}),a(this.element).off("click","#"+this.elementId+"_acitveInactiveItem").on("click","#"+this.elementId+"_acitveInactiveItem",function(){b.activeInactiveFunction()}),a(this.element).off("click","#"+this.elementId+"_editItem").on("click","#"+this.elementId+"_editItem",function(){b.editFunction()}),a(this.element).off("click","#"+this.elementId+"_saveItem").on("click","#"+this.elementId+"_saveItem",function(){b.saveFunction()}),a(this.element).off("click","#"+this.elementId+"_deleteItem").on("click","#"+this.elementId+"_deleteItem",function(){b.deleteFunction()}),a(this.element).off("click","#"+this.elementId+"_cancelItem").on("click","#"+this.elementId+"_cancelItem",function(){b.cancelFunction()}),a(this.element).off("click","#"+this.elementId+"_batchJob").on("click","#"+this.elementId+"_batchJob",function(){b.batchJobFunction()}),a(this.element).off("click","#"+this.elementId+"_addItem").on("click","#"+this.elementId+"_addItem",function(){b.addItemFunction()}),a(this.element).off("click","#"+this.elementId+"_normalMode").on("click","#"+this.elementId+"_normalMode",function(){b.normalModeFunction()}),a(this.element).off("click","input[type='checkbox']").on("click","input[type='checkbox']",function(){a(this).prop("checked")?b.selectNumber++:b.selectNumber--,b.batchModeButtonStatus()}),a(this.element).off("focus",".hid_sortable_key").on("focus",".hid_sortable_key",function(){a(this).parents("span").find(".sortable_text_div_key").animate({width:"90%"},1e3),a(this).parents("span").find(".sortable_text_div_value").animate({width:"0%",opacity:"hide"},1e3)}),a(this.element).off("focusout",".hid_sortable_key").on("focusout",".hid_sortable_key",function(){a(this).parents("span").find(".sortable_text_div_key").animate({width:"40%"},1e3),a(this).parents("span").find(".sortable_text_div_value").animate({width:"60%",opacity:"show"},1e3)}),a(this.element).off("focus",".sortable_text_div_value").on("focus",".sortable_text_div_value",function(){a(this).parents("span").find(".sortable_text_div_key").animate({width:"0%",opacity:"hide"},1e3),a(this).parents("span").find(".sortable_text_div_value").animate({width:"90%"},1e3)}),a(this.element).off("focusout",".sortable_text_div_value").on("focusout",".sortable_text_div_value",function(){a(this).parents("span").find(".sortable_text_div_key").animate({width:"40%",opacity:"show"},1e3),a(this).parents("span").find(".sortable_text_div_value").animate({width:"60%"},1e3)})},buildSortHTML:function(){var b=a(this.element);b.empty(),b.addClass("sortable_div_container");var c="sortable_list_container";this.options.groupMode||(c="sortable_list_single_container");var d=a('<div class="'+c+'" id="div_'+this.elementId+'"></div>'),e=a('<ul id="ul_'+this.elementId+'"></ul>');if(this.ulElement=e,b.append(d),d.append(e),e.empty(),e.addClass("sortable_connectedSortable_"+this.elementId),this.options.groupMode){e.addClass("sortable_default");var f=a('<ul id="ul_disable_'+this.elementId+'"></ul>');this.disableUlElement=f,f.empty(),f.addClass("sortable_default"),f.addClass("sortable_connectedSortable_"+this.elementId),d.append(f)}else e.addClass("sortable_single_default");this.activedData,this.inactivedData;var i=a('<div id="buttons_'+this.elementId+'">');this.buttonElements=i,i.addClass("sortable_button_group_default"),b.append(i),this.options.activeButton&&i.append(a(this.getButtonHtml("act"))),this.options.batchButton&&(i.append(a(this.getButtonHtml("bat"))),i.append(a(this.getButtonHtml("nol")))),this.options.editButton&&(i.append(a(this.getButtonHtml("edi"))),i.append(a(this.getButtonHtml("sav"))),i.append(a(this.getButtonHtml("can")))),this.options.addButton&&i.append(a(this.getButtonHtml("add"))),this.options.deleteButton&&i.append(a(this.getButtonHtml("del"))),this.options.submitButton&&i.append(a(this.getButtonHtml("sub"))),this.prepareModelData()},buildSortTable:function(){var b=this,c={placeholder:"ui-state-highlight",axis:"y",cursor:"s-resize",opacity:.8,stop:function(a,c){b.options.groupMode||b.recordNewOrder(),b.refreshData(),c.item.removeAttr("style")}};this.options.groupMode?(c.connectWith=".sortable_connectedSortable_"+this.elementId,this.sortableObj=a(".sortable_connectedSortable_"+this.elementId).sortable(c)):this.sortableObj=a(this.ulElement).sortable(c)},recordNewOrder:function(){var b=[],c=this;a.each(a(this.element).find("li .hid_sortable_id"),function(d,e){a.each(c.options.sortJsonData,function(c,f){a(e).val()==f.id&&(f.index=d++,b.push(f))})}),this.options.sortJsonData=b},refreshData:function(){this.activedData=[],this.inactivedData=[];var b=[],c=a(this.ulElement),d=this.activedData,e=this.inactivedData,f=this;return a.each(this.options.sortJsonData,function(g,h){var i=a.trim(h.value),j=a.trim(h.key),k=a.trim(h.id),l=h.isActiveFlag,m=a(f.element).find("#li_sortable_item_"+f.elementId+"_"+k);if(0==m.length){var n=f.getKeyValueReadOnlyString(j,i),o=a('<li class="ui-state-default" id="li_sortable_item_'+f.elementId+"_"+k+'">'+'<input type="checkbox" class="li_sortable_checkbox hide" id="li_sortable_checkbox_'+k+'"/>'+'<input type="hidden" class="hid_sortable_id" id="hid_sortable_id_'+k+'" value="'+k+'"/>'+'<span class="sortable_read_only_text" title="'+n+'">'+n+"</span>"+'<span class="sortable_edit_text hide">'+f.getKeyValueString('<input type="text" class="hid_sortable_key sortable_text_key" id="hid_sortable_key_'+k+'" value="'+j+'"/>','<input type="text" class="hid_sortable_value sortable_text_value" id="hid_sortable_value_'+k+'" value="'+i+'"/>')+"</span>"+"</li>");c.append(o),b.push(o),m=a(f.element).find("#li_sortable_item_"+f.elementId+"_"+k)}var p=m.find(".hid_sortable_value"),q=m.find(".sortable_read_only_text");i!=p.val()&&p.val(i);var r=m.find(".hid_sortable_key");j!=r.val()&&r.val(j),q.html(f.getKeyValueReadOnlyString(j,i)),q.attr("title",f.getKeyValueReadOnlyString(j,i)),l?(d.push(a("#li_sortable_item_"+f.elementId+"_"+k)),m.removeClass("ui-state-disabled")):(e.push(a("#li_sortable_item_"+f.elementId+"_"+k)),m.addClass("ui-state-disabled")),m.addClass("sortable-processed")}),a(this.element).find("li").remove(":not(.sortable-processed)"),a(this.element).find("li").removeClass("sortable-processed"),this.refreshItemsDisplay(),b},getOrSetModelData:function(b){return"undefined"==typeof b||null===b?{sortJsonData:this.options.sortJsonData,activedData:this.activedData,inactivedData:this.inactivedData,newAddedItems:this.newAddedItemsArr,deletedItems:this.deletedItemsArr}:(this.options=a.extend({},this.options,b),this.init(),void 0)},selectItemFunction:function(b){this.isEditMode||(this.isBatchJob?(this.selectedItem=null,a(this.element).find(".ui-state-active").removeClass("ui-state-active")):(this.selectedItem=b,"undefined"!=typeof this.selectedItem&&null!==this.selectedItem?(this.selectOneItemEnableButtonsDelegate(),a(this.element).find(".ui-state-active").removeClass("ui-state-active"),this.selectedItem.addClass("ui-state-active")):this.unselectItemDisableButtonsDelegate()))},activeInactiveFunction:function(){if(this.isBatchJob){var d=this.getSelectItems(),e=d.checkedItems,f=this;a.each(e,function(b,c){var d=f.findDataFromModel(a.trim(c.find(".hid_sortable_id").val())),e=d.isActiveFlag;d.isActiveFlag=e?!1:!0})}else if("undefined"!=typeof this.selectedItem&&null!==this.selectedItem){var b=this.findDataFromModel(a.trim(this.selectedItem.find(".hid_sortable_id").val())),c=b.isActiveFlag;b.isActiveFlag=c?!1:!0}this.refreshData()},getSelectItems:function(){var b=a(this.element).find("li .li_sortable_checkbox"),c=[],d=[];return a.each(b,function(b,e){a(e).prop("checked")?c.push(a(e).parent()):d.push(a(e).parent())}),{checkedItems:c,uncheckedItems:d}},findDataFromModel:function(b){var c=null;return a.each(this.options.sortJsonData,function(a,d){return d.id==b?(c=d,!1):void 0}),c},editFunction:function(){if("undefined"!=typeof this.selectedItem&&null!==this.selectedItem){this.isEditMode=!0,this.changeEditModeButtonsStatus();var b=this.findDataFromModel(a.trim(this.selectedItem.find(".hid_sortable_id").val()));this.selectedItem.find(".hid_sortable_value").val(b.value),this.selectedItem.find(".hid_sortable_key").val(b.key),this.selectedItem.find(".sortable_read_only_text").hide(),this.selectedItem.find(".sortable_edit_text").removeClass("hide")}},saveFunction:function(){if(this.isEditMode=!1,this.changeEditModeButtonsStatus(),"undefined"!=typeof this.selectedItem&&null!==this.selectedItem){var b=a.trim(this.selectedItem.find(".hid_sortable_value").val()),c=a.trim(this.selectedItem.find(".hid_sortable_key").val()),d=this.findDataFromModel(a.trim(this.selectedItem.find(".hid_sortable_id").val()));d.value=b,d.key=c,this.selectedItem.find(".sortable_read_only_text").show(),this.selectedItem.find(".sortable_edit_text").addClass("hide")}this.refreshData()},cancelFunction:function(){if(this.isEditMode=!1,this.changeEditModeButtonsStatus(),"undefined"!=typeof this.selectedItem&&null!==this.selectedItem){var b=this.findDataFromModel(a.trim(this.selectedItem.find(".hid_sortable_id").val()));this.selectedItem.find(".hid_sortable_value").val(b.value),this.selectedItem.find(".hid_sortable_key").val(b.key),this.selectedItem.find(".sortable_read_only_text").show(),this.selectedItem.find(".sortable_edit_text").addClass("hide")}this.refreshData()},deleteDataFromModel:function(a){for(var b=-1,c=0;c<this.options.sortJsonData.length;c++)if(this.options.sortJsonData[c].id==a){b=c;break}b>=0&&this.options.sortJsonData.splice(b,1)},deleteFunction:function(){var b=this;if(this.isBatchJob){var e=this.getSelectItems(),f=e.checkedItems,b=this;"function"==typeof this.options.deleteCallBack?this.options.deleteCallBack(f)&&(a.each(f,function(c,d){var e=b.findDataFromModel(a.trim(d.find(".hid_sortable_id").val()));b.deleteDataFromModel(e.id),d.remove();var f=!1;a.each(b.newAddedItemsArr,function(a,c){return c.id==e.id?(b.newAddedItemsArr.splice(a,1),f=!0,!1):void 0}),f||b.deletedItemsArr.push(e)}),this.selectNumber=0,this.batchModeButtonStatus()):a.error("DeleteCallBack "+this.options.deleteCallBack+" is not a function!")}else if("function"==typeof this.options.deleteCallBack){if(this.options.deleteCallBack(this.selectedItem)){if("undefined"!=typeof this.selectedItem&&null!==this.selectedItem){var c=this.findDataFromModel(a.trim(this.selectedItem.find(".hid_sortable_id").val()));this.deleteDataFromModel(c.id),this.selectedItem.remove(),this.selectItemFunction(null);var d=!1;a.each(b.newAddedItemsArr,function(a,e){return e.id==c.id?(b.newAddedItemsArr.splice(a,1),d=!0,!1):void 0}),d||this.deletedItemsArr.push(c)}this.refreshData()}}else a.error("DeleteCallBack "+this.options.deleteCallBack+" is not a function!")},addItemFunction:function(){var a=this.startIndex;a<this.options.sortJsonData.length&&(a=this.options.sortJsonData.length);var b=a++,c=this.getOneItemJsonObj(this.options.defaultNewItemKey,b,this.options.enableNewItem,this.options.defaultNewItemText);this.options.sortJsonData.push(c);var d=this.refreshData();this.newAddedItemsArr.push(c),this.selectItemFunction(d[0]),this.editFunction(),this.startIndex=a},getOneItemJsonObj:function(a,b,c,d){return{index:b,id:b,key:a,isActiveFlag:c,value:d}},batchJobFunction:function(){this.isBatchJob=!0,this.batchModeButtonStatus(),this.selectItemFunction(null),a(this.element).find("li .li_sortable_checkbox").show().removeClass("hide")},normalModeFunction:function(){this.isBatchJob=!1,this.selectNumber=0,this.batchModeButtonStatus();var c=a(this.element).find("li .li_sortable_checkbox");c.hide().addClass("hide"),a.each(c,function(b,c){a(c).prop("checked",!1)})},batchModeButtonStatus:function(){this.isBatchJob?this.enterBatchJobModeButtonStatusDelegate():this.exitBatchJobModeButtonStatusDelegate(),this.selectNumber>0?this.enableBatchButtonDelegate():this.disableBatchJobButtonDelegate()},changeEditModeButtonsStatus:function(){this.isEditMode?this.enterEditModeButtonsStatusDelegate():this.exitEditModeButtonsStatusDelegate()},refreshItemsDisplay:function(){if(this.options.groupMode){var b=a(this.ulElement).find(".ui-state-disabled");a(this.ulElement).find("li").remove(".ui-state-disabled"),a(this.disableUlElement).append(b);var c=a(this.disableUlElement).find("li:not(.ui-state-disabled)");a(this.disableUlElement).find("li").remove(":not(.ui-state-disabled)"),a(this.ulElement).append(c),this.recordNewOrder()}this.sortableObj.sortable("option","items","li:not(.ui-state-disabled)"),this.sortableObj.sortable("option","cancel",".ui-state-disabled,input"),this.sortableObj.sortable("refresh")},getButtonHtml:function(a){var b="",c="ui-widget ui-button-text-only sortable_button_default ui-state-default "+this.options.buttonClass;switch(a){case"act":b='<input type="button" class="ui-state-disabled '+c+'" id="'+this.elementId+'_acitveInactiveItem" disabled="disabled" value="'+this.options.activeButtonText+'"/>';break;case"bat":b='<input type="button" class="'+c+'" id="'+this.elementId+'_batchJob"  value="'+this.options.batchButtonText+'"/>';break;case"nol":b='<input type="button" id="'+this.elementId+'_normalMode" class="hide '+c+'" value="'+this.options.normalModeButtonText+'"/>';break;case"edi":b='<input type="button" class="ui-state-disabled '+c+'" id="'+this.elementId+'_editItem" disabled="disabled" value="'+this.options.editButtonText+'"/>';break;case"sav":b='<input type="button" id="'+this.elementId+'_saveItem" class="hide '+c+'" value="'+this.options.saveButtonText+'"/>';break;case"can":b='<input type="button" id="'+this.elementId+'_cancelItem" class="hide '+c+'" value="'+this.options.cancelButtonText+'"/>';break;case"add":b='<input type="button" class="'+c+'" id="'+this.elementId+'_addItem" value="'+this.options.addButtonText+'"/>';break;case"del":b='<input type="button" class="ui-state-disabled '+c+'" id="'+this.elementId+'_deleteItem" disabled="disabled" value="'+this.options.deleteButtonText+'"/>';break;case"sub":b='<input type="button" class="'+c+'" id="'+this.elementId+'_submit" value="'+this.options.submitButtonText+'"/>'}return b},prepareModelData:function(){var b=0;a.each(this.options.sortJsonData,function(a,c){c.id=b++,c.index=a++}),this.startIndex=b},selectOneItemEnableButtonsDelegate:function(){a("#"+this.elementId+"_editItem").removeAttr("disabled"),a("#"+this.elementId+"_deleteItem").removeAttr("disabled"),a("#"+this.elementId+"_acitveInactiveItem").removeAttr("disabled"),a("#"+this.elementId+"_editItem").removeClass("ui-state-disabled"),a("#"+this.elementId+"_deleteItem").removeClass("ui-state-disabled"),a("#"+this.elementId+"_acitveInactiveItem").removeClass("ui-state-disabled")},unselectItemDisableButtonsDelegate:function(){a("#"+this.elementId+"_editItem").attr("disabled","disabled"),a("#"+this.elementId+"_deleteItem").attr("disabled","disabled"),a("#"+this.elementId+"_acitveInactiveItem").attr("disabled","disabled"),a("#"+this.elementId+"_editItem").addClass("ui-state-disabled"),a("#"+this.elementId+"_deleteItem").addClass("ui-state-disabled"),a("#"+this.elementId+"_acitveInactiveItem").addClass("ui-state-disabled")},enterEditModeButtonsStatusDelegate:function(){a("#"+this.elementId+"_saveItem").show().removeClass("hide"),a("#"+this.elementId+"_cancelItem").show().removeClass("hide"),a("#"+this.elementId+"_editItem").hide().addClass("hide"),a("#"+this.elementId+"_addItem").hide().addClass("hide"),a("#"+this.elementId+"_deleteItem").hide().addClass("hide"),a("#"+this.elementId+"_batchJob").hide().addClass("hide")},exitEditModeButtonsStatusDelegate:function(){a("#"+this.elementId+"_saveItem").hide().addClass("hide"),a("#"+this.elementId+"_cancelItem").hide().addClass("hide"),a("#"+this.elementId+"_editItem").show().removeClass("hide"),a("#"+this.elementId+"_addItem").show().removeClass("hide"),a("#"+this.elementId+"_deleteItem").show().removeClass("hide"),a("#"+this.elementId+"_batchJob").show().removeClass("hide")},enterBatchJobModeButtonStatusDelegate:function(){a("#"+this.elementId+"_batchJob").hide().addClass("hide"),a("#"+this.elementId+"_normalMode").show().removeClass("hide"),a("#"+this.elementId+"_addItem").hide().addClass("hide"),a("#"+this.elementId+"_editItem").hide().addClass("hide"),a("#"+this.elementId+"_acitveInactiveItem").removeAttr("disabled"),a("#"+this.elementId+"_deleteItem").removeAttr("disabled"),a("#"+this.elementId+"_deleteItem").removeClass("ui-state-disabled"),a("#"+this.elementId+"_acitveInactiveItem").removeClass("ui-state-disabled"),a("#"+this.elementId+"_editItem").attr("disabled","disabled"),a("#"+this.elementId+"_editItem").addClass("ui-state-disabled")},exitBatchJobModeButtonStatusDelegate:function(){a("#"+this.elementId+"_batchJob").show().removeClass("hide"),a("#"+this.elementId+"_normalMode").hide().addClass("hide"),a("#"+this.elementId+"_editItem").show().removeClass("hide"),a("#"+this.elementId+"_addItem").show().removeClass("hide"),a("#"+this.elementId+"_acitveInactiveItem").attr("disabled","disabled"),a("#"+this.elementId+"_deleteItem").attr("disabled","disabled"),a("#"+this.elementId+"_deleteItem").addClass("ui-state-disabled"),a("#"+this.elementId+"_acitveInactiveItem").addClass("ui-state-disabled")},enableBatchButtonDelegate:function(){a("#"+this.elementId+"_acitveInactiveItem").removeAttr("disabled"),a("#"+this.elementId+"_deleteItem").removeAttr("disabled"),a("#"+this.elementId+"_deleteItem").removeClass("ui-state-disabled"),a("#"+this.elementId+"_acitveInactiveItem").removeClass("ui-state-disabled")},disableBatchJobButtonDelegate:function(){a("#"+this.elementId+"_acitveInactiveItem").attr("disabled","disabled"),a("#"+this.elementId+"_deleteItem").attr("disabled","disabled"),a("#"+this.elementId+"_deleteItem").addClass("ui-state-disabled"),a("#"+this.elementId+"_acitveInactiveItem").addClass("ui-state-disabled")},getKeyValueString:function(a,b){return this.options.keyValueMode?'<div class="sortable_text_div_key">Key: '+a+' </div><div class="sortable_text_div_value">Value: '+b+"</div>":b},getKeyValueReadOnlyString:function(a,b){return this.options.keyValueMode?"Key: "+a+"    Value: "+b:b}};var f=function(a,b){"undefined"!=typeof a&&null!==a&&a.length>1&&(a[1].options[b]=a[0])},g=function(a,b){return"undefined"!=typeof a&&null!==a?a.length>1?a[1][b].call(a[1],a[0]):a[0][b].call(a[0]):void 0},h={Destroy:function(){var c=a.data(this,"plugin_"+b);c&&(a(c.element).empty(),a.removeData(this,"plugin_"+b))},ModelData:function(){var a=arguments;return g(a,"getOrSetModelData")},SubmitCallback:function(){var a=arguments;f(a,"submitCallBack")},DeleteCallBack:function(){var a=arguments;f(a,"deleteCallBack")}};a.fn[b]=function(){var c=arguments,d=null;return this.each(function(){if(a.data(this,"plugin_"+b)){var f=c[0];if(h[f])f=h[f],arguments=Array.prototype.slice.call(c,1),arguments.push(a.data(this,"plugin_"+b)),d=f.apply(this,arguments);else if("object"!=typeof f&&f)return a.error("Method"+f+"does not exist on jQuery."+b),this}else a.data(this,"plugin_"+b,new e(this,c[0]))}),"undefined"!=typeof d&&null!==d?d:this}});