!function(a){"function"==typeof define&&define.amd?define(["jquery","jqueryui"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){var b="sorttable",c="v0.0.1",d={keyValueMode:!0,enableNewItem:!1,defaultNewItemKey:"NK",defaultNewItemText:"new value",sortJsonData:[],activeButton:!0,activeButtonText:"Active/Inactive",batchButton:!0,batchButtonText:"Batch Mode",normalModeButtonText:"Normal Mode",editButton:!0,editButtonText:"Edit Item",saveButtonText:"save Item",cancelButtonText:"Cancel",addButton:!0,addButtonText:"Add Item",deleteButton:!0,deleteButtonText:"Delete Item",submitButton:!0,submitButtonText:"Submit",submitCallBack:function(){}},e=function(e,f){this.element=e,this.elementId=a(e).attr("id"),this.ulElement=null,this.buttonElements=null,this.startIndex=0,this.options=a.extend({},d,f),this.activedData=[],this.inactivedData=[],this.selectedItem={},this.isBatchJob=!1,this.isEditMode=!1,this.selectNumber=0,this._defaults=d,this._name=b,this._version=c,this.init()};e.prototype={init:function(){this.buildSortHTML(),this.buildSortTable(),this.refreshData();var b=this;a(this.ulElement).on("click","li",function(){b.selectItemFuction(a(this))}),a(this.element).on("click","#"+this.elementId+"_submit",function(a){b.options.submitCallBack(a)}),a(this.element).on("click","#"+this.elementId+"_acitveInactiveItem",function(){b.activeInactiveFunction()}),a(this.element).on("click","#"+this.elementId+"_editItem",function(){b.editFunction()}),a(this.element).on("click","#"+this.elementId+"_saveItem",function(){b.saveFunction()}),a(this.element).on("click","#"+this.elementId+"_deleteItem",function(){b.deleteFunction()}),a(this.element).on("click","#"+this.elementId+"_cancelItem",function(){b.cancelFunction()}),a(this.element).on("click","#"+this.elementId+"_batchJob",function(){b.batchJobFunction()}),a(this.element).on("click","#"+this.elementId+"_addItem",function(){b.addItemFunction()}),a(this.element).on("click","#"+this.elementId+"_normalMode",function(){b.normalModeFunction()}),a(this.ulElement).on("click","input[type='checkbox']",function(){a(this).prop("checked")?b.selectNumber++:b.selectNumber--,b.batchModeButtonStatus()})},buildSortHTML:function(){var b=a(this.element),c=a('<ul id="ul_'+this.elementId+'"></ul>');this.ulElement=c,b.append(c),c.empty(),c.addClass("sortable_default"),this.activedData,this.inactivedData;var f=a('<div id="buttons_'+this.elementId+'">');this.buttonElements=f,b.append(f),this.options.activeButton&&f.append(a(this.getButtonHtml("act"))),this.options.batchButton&&(f.append(a(this.getButtonHtml("bat"))),f.append(a(this.getButtonHtml("nol")))),this.options.editButton&&(f.append(a(this.getButtonHtml("edi"))),f.append(a(this.getButtonHtml("sav"))),f.append(a(this.getButtonHtml("can")))),this.options.addButton&&f.append(a(this.getButtonHtml("add"))),this.options.deleteButton&&f.append(a(this.getButtonHtml("del"))),this.options.submitButton&&f.append(a(this.getButtonHtml("sub"))),this.prepareModelData()},buildSortTable:function(){var b=this;a(this.ulElement).sortable({placeholder:"ui-state-highlight",axis:"y",cursor:"s-resize",opacity:.8,stop:function(a,c){b.recordNewOrder(),b.refreshData(),c.item.removeAttr("style")}}),a(this.ulElement).disableSelection()},recordNewOrder:function(){var b=[],c=this;a.each(a(this.ulElement).find("li .hid_sortable_id"),function(d,e){a.each(c.options.sortJsonData,function(c,d){a(e).val()==d.id&&b.push(d)})}),this.options.sortJsonData=b},refreshData:function(){this.activedData=[],this.inactivedData=[];var b=[],c=a(this.ulElement),d=this.activedData,e=this.inactivedData,f=this;return a.each(this.options.sortJsonData,function(g,h){var i=a.trim(h.value),j=a.trim(h.key),k=a.trim(h.id),l=h.isActiveFlag,m=a("#li_sortable_item_"+f.elementId+"_"+k);if(0==m.length){var n=a('<li class="ui-state-default" id="li_sortable_item_'+f.elementId+"_"+k+'">'+'<input type="checkbox" class="li_sortable_checkbox hide" id="li_sortable_checkbox_'+k+'"/>'+'<input type="hidden" class="hid_sortable_id" id="hid_sortable_id_'+k+'" value="'+k+'"/>'+'<span class="sortable_read_only_text">'+f.getKeyValueString(j,i)+"</span>"+'<span class="sortable_edit_text hide">'+f.getKeyValueString('<input type="text" class="hid_sortable_key" id="hid_sortable_key_'+k+'" value="'+j+'"/>','<input type="text" class="hid_sortable_value" id="hid_sortable_value_'+k+'" value="'+i+'"/>')+"</span>"+"</li>");c.append(n),b.push(n),m=a("#li_sortable_item_"+f.elementId+"_"+k)}var o=m.find(".hid_sortable_value"),p=m.find(".sortable_read_only_text");i!=o.val()&&o.val(i);var q=m.find(".hid_sortable_key");j!=q.val()&&q.val(j),p.html(f.getKeyValueString(j,i)),l?(d.push(a("#li_sortable_item_"+f.elementId+"_"+k)),m.removeClass("ui-state-disabled")):(e.push(a("#li_sortable_item_"+f.elementId+"_"+k)),m.addClass("ui-state-disabled")),m.addClass("sortable-processed")}),this.ulElement.find("li").remove(":not(.sortable-processed)"),this.ulElement.find("li").removeClass("sortable-processed"),this.refreshItemsDisplay(),b},getOrSetModelData:function(b){return"undefined"==typeof b||null===b?{sortJsonData:this.options.sortJsonData,activedData:this.activedData,inactivedData:this.inactivedData}:(this.options=a.extend({},this.options,b),this.prepareModelData(),this.refreshData(),void 0)},selectItemFuction:function(b){this.isEditMode||(this.isBatchJob?(this.selectedItem=null,a(this.ulElement).find(".ui-state-active").removeClass("ui-state-active")):(this.selectedItem=b,"undefined"!=typeof this.selectedItem&&null!==this.selectedItem?(this.selectOneItemEnableButtonsDelegate(),this.selectedItem.parent().find(".ui-state-active").removeClass("ui-state-active"),this.selectedItem.addClass("ui-state-active")):this.unselectItemDisableButtonsDelegate()))},activeInactiveFunction:function(){if(this.isBatchJob){var d=this.getSelectItems(),e=d.checkedItems,f=this;a.each(e,function(b,c){var d=f.findDataFromModel(a.trim(c.find(".hid_sortable_id").val())),e=d.isActiveFlag;d.isActiveFlag=e?!1:!0})}else if("undefined"!=typeof this.selectedItem&&null!==this.selectedItem){var b=this.findDataFromModel(a.trim(this.selectedItem.find(".hid_sortable_id").val())),c=b.isActiveFlag;b.isActiveFlag=c?!1:!0}this.refreshData()},getSelectItems:function(){var b=a(this.element).find("li .li_sortable_checkbox"),c=[],d=[];return a.each(b,function(b,e){a(e).prop("checked")?c.push(a(e).parent()):d.push(a(e).parent())}),{checkedItems:c,uncheckedItems:d}},findDataFromModel:function(b){var c=null;return a.each(this.options.sortJsonData,function(a,d){return d.id==b?(c=d,!1):void 0}),c},editFunction:function(){if("undefined"!=typeof this.selectedItem&&null!==this.selectedItem){this.isEditMode=!0,this.changeEditModeButtonsStatus();var b=this.findDataFromModel(a.trim(this.selectedItem.find(".hid_sortable_id").val()));this.selectedItem.find(".hid_sortable_value").val(b.value),this.selectedItem.find(".hid_sortable_key").val(b.key),this.selectedItem.find(".sortable_read_only_text").hide(),this.selectedItem.find(".sortable_edit_text").removeClass("hide")}},saveFunction:function(){if(this.isEditMode=!1,this.changeEditModeButtonsStatus(),"undefined"!=typeof this.selectedItem&&null!==this.selectedItem){var b=a.trim(this.selectedItem.find(".hid_sortable_value").val()),c=a.trim(this.selectedItem.find(".hid_sortable_key").val()),d=this.findDataFromModel(a.trim(this.selectedItem.find(".hid_sortable_id").val()));d.value=b,d.key=c,this.selectedItem.find(".sortable_read_only_text").show(),this.selectedItem.find(".sortable_edit_text").addClass("hide")}this.refreshData()},cancelFunction:function(){if(this.isEditMode=!1,this.changeEditModeButtonsStatus(),"undefined"!=typeof this.selectedItem&&null!==this.selectedItem){var b=this.findDataFromModel(a.trim(this.selectedItem.find(".hid_sortable_id").val()));this.selectedItem.find(".hid_sortable_value").val(b.value),this.selectedItem.find(".hid_sortable_key").val(b.key),this.selectedItem.find(".sortable_read_only_text").show(),this.selectedItem.find(".sortable_edit_text").addClass("hide")}this.refreshData()},deleteDataFromModel:function(a){for(var b=-1,c=0;c<this.options.sortJsonData.length;c++)if(this.options.sortJsonData[c].id==a){b=c;break}b>=0&&this.options.sortJsonData.splice(b,1)},deleteFunction:function(){if(this.isBatchJob){var c=this.getSelectItems(),d=c.checkedItems,e=this;a.each(d,function(b,c){var d=e.findDataFromModel(a.trim(c.find(".hid_sortable_id").val()));e.deleteDataFromModel(d.id),c.remove()}),this.selectNumber=0,this.batchModeButtonStatus()}else{if("undefined"!=typeof this.selectedItem&&null!==this.selectedItem){var b=this.findDataFromModel(a.trim(this.selectedItem.find(".hid_sortable_id").val()));this.deleteDataFromModel(b.id),this.selectedItem.remove(),this.selectItemFuction(null)}this.refreshData()}},addItemFunction:function(){var a=this.startIndex;a<this.options.sortJsonData.length&&(a=this.options.sortJsonData.length);var b=a++;this.options.sortJsonData.push(this.getOneItemJsonObj(this.options.defaultNewItemKey,b,this.options.enableNewItem,this.options.defaultNewItemText));var c=this.refreshData();this.selectItemFuction(c[0]),this.editFunction()},getOneItemJsonObj:function(a,b,c,d){return{id:b,key:a,isActiveFlag:c,value:d}},batchJobFunction:function(){this.isBatchJob=!0,this.batchModeButtonStatus(),this.selectItemFuction(null),a(this.element).find("li .li_sortable_checkbox").show()},normalModeFunction:function(){this.isBatchJob=!1,this.selectNumber=0,this.batchModeButtonStatus();var c=a(this.element).find("li .li_sortable_checkbox");c.hide(),a.each(c,function(b,c){a(c).prop("checked",!1)})},batchModeButtonStatus:function(){this.isBatchJob?this.enterBatchJobModeButtonStatusDelegate():this.exitBatchJobModeButtonStatusDelegate(),this.selectNumber>0?this.enableBatchButtonDelegate():this.disableBatchJobButtonDelegate()},changeEditModeButtonsStatus:function(){this.isEditMode?this.enterEditModeButtonsStatusDelegate():this.exitEditModeButtonsStatusDelegate()},refreshItemsDisplay:function(){a(this.ulElement).sortable("option","items","li:not(.ui-state-disabled)"),a(this.ulElement).sortable("option","cancel",".ui-state-disabled,input"),a(this.ulElement).sortable("refresh")},getButtonHtml:function(a){var b="";switch(a){case"act":b='<input type="button" id="'+this.elementId+'_acitveInactiveItem" disabled="disabled" value="'+this.options.activeButtonText+'"/>';break;case"bat":b='<input type="button" id="'+this.elementId+'_batchJob"  value="'+this.options.batchButtonText+'"/>';break;case"nol":b='<input type="button" id="'+this.elementId+'_normalMode" class="hide" value="'+this.options.normalModeButtonText+'"/>';break;case"edi":b='<input type="button" id="'+this.elementId+'_editItem" disabled="disabled" value="'+this.options.editButtonText+'"/>';break;case"sav":b='<input type="button" id="'+this.elementId+'_saveItem" class="hide" value="'+this.options.saveButtonText+'"/>';break;case"can":b='<input type="button" id="'+this.elementId+'_cancelItem" class="hide" value="'+this.options.cancelButtonText+'"/>';break;case"add":b='<input type="button" id="'+this.elementId+'_addItem" value="'+this.options.addButtonText+'"/>';break;case"del":b='<input type="button" id="'+this.elementId+'_deleteItem" disabled="disabled" value="'+this.options.deleteButtonText+'"/>';break;case"sub":b='<input type="button" id="'+this.elementId+'_submit" value="'+this.options.submitButtonText+'"/>'}return b},prepareModelData:function(){var b=0;a.each(this.options.sortJsonData,function(a,c){c.id=b++}),this.startIndex=b},selectOneItemEnableButtonsDelegate:function(){a("#"+this.elementId+"_editItem").removeAttr("disabled"),a("#"+this.elementId+"_deleteItem").removeAttr("disabled"),a("#"+this.elementId+"_acitveInactiveItem").removeAttr("disabled")},unselectItemDisableButtonsDelegate:function(){a("#"+this.elementId+"_editItem").attr("disabled","disabled"),a("#"+this.elementId+"_deleteItem").attr("disabled","disabled"),a("#"+this.elementId+"_acitveInactiveItem").attr("disabled","disabled")},enterEditModeButtonsStatusDelegate:function(){a("#"+this.elementId+"_saveItem").show(),a("#"+this.elementId+"_cancelItem").show(),a("#"+this.elementId+"_editItem").hide(),a("#"+this.elementId+"_addItem").hide(),a("#"+this.elementId+"_deleteItem").hide(),a("#"+this.elementId+"_batchJob").hide()},exitEditModeButtonsStatusDelegate:function(){a("#"+this.elementId+"_saveItem").hide(),a("#"+this.elementId+"_cancelItem").hide(),a("#"+this.elementId+"_editItem").show(),a("#"+this.elementId+"_addItem").show(),a("#"+this.elementId+"_deleteItem").show(),a("#"+this.elementId+"_batchJob").show()},enterBatchJobModeButtonStatusDelegate:function(){a("#"+this.elementId+"_batchJob").hide(),a("#"+this.elementId+"_normalMode").show(),a("#"+this.elementId+"_addItem").hide(),a("#"+this.elementId+"_editItem").hide(),a("#"+this.elementId+"_acitveInactiveItem").removeAttr("disabled"),a("#"+this.elementId+"_deleteItem").removeAttr("disabled"),a("#"+this.elementId+"_editItem").attr("disabled","disabled")},exitBatchJobModeButtonStatusDelegate:function(){a("#"+this.elementId+"_batchJob").show(),a("#"+this.elementId+"_normalMode").hide(),a("#"+this.elementId+"_editItem").show(),a("#"+this.elementId+"_addItem").show(),a("#"+this.elementId+"_acitveInactiveItem").attr("disabled","disabled"),a("#"+this.elementId+"_deleteItem").attr("disabled","disabled")},enableBatchButtonDelegate:function(){a("#"+this.elementId+"_acitveInactiveItem").removeAttr("disabled"),a("#"+this.elementId+"_deleteItem").removeAttr("disabled")},disableBatchJobButtonDelegate:function(){a("#"+this.elementId+"_acitveInactiveItem").attr("disabled","disabled"),a("#"+this.elementId+"_deleteItem").attr("disabled","disabled")},getKeyValueString:function(a,b){return this.options.keyValueMode?"Key: "+a+", Value: "+b:b}};var f=function(a,b){"undefined"!=typeof a&&null!==a&&a.length>1&&(a[1].options[b]=a[0])},g=function(a,b){return"undefined"!=typeof a&&null!==a?a.length>1?a[1][b].call(a[1],a[0]):a[0][b].call(a[0]):void 0},h={ModelData:function(){var a=arguments;return g(a,"getOrSetModelData")},SubmitCallback:function(){var a=arguments;f(a,"submitCallBack")}};a.fn[b]=function(){var c=arguments,d=null;return this.each(function(){if(a.data(this,"plugin_"+b)){var f=c[0];if(h[f])f=h[f],arguments=Array.prototype.slice.call(c,1),arguments.push(a.data(this,"plugin_"+b)),d=f.apply(this,arguments);else if("object"!=typeof f&&f)return a.error("Method"+f+"does not exist on jQuery.pluginName"),this}else a.data(this,"plugin_"+b,new e(this,c[0]))}),"undefined"!=typeof d&&null!==d?d:this}});